#!/usr/bin/env npx ts-node --esm
import * as cdk from "aws-cdk-lib";
import { StingyVpnStack } from "../lib/stingy-vpn-stack.js";
const app = new cdk.App();
// Get configuration from context or environment
const environment = (app.node.tryGetContext("environment") ?? "dev");
const cloudflareZoneId = app.node.tryGetContext("cloudflareZoneId") ??
    process.env.CLOUDFLARE_ZONE_ID ??
    "";
const cloudflareRecordId = app.node.tryGetContext("cloudflareRecordId") ??
    process.env.CLOUDFLARE_RECORD_ID ??
    "";
// Validate required configuration
if (!cloudflareZoneId || !cloudflareRecordId) {
    console.warn("Warning: Cloudflare configuration not provided. " +
        "Set cloudflareZoneId and cloudflareRecordId via context or environment variables.");
}
// Create the stack
new StingyVpnStack(app, `StingyVpnStack-${environment}`, {
    environment,
    cloudflareZoneId,
    cloudflareRecordId,
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION ?? "ap-northeast-1",
    },
    description: `Stingy VPN - Low-cost VPN solution using EC2 Spot Instances (${environment})`,
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2Nkay9iaW4vYXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEtBQUssR0FBRyxNQUFNLGFBQWEsQ0FBQztBQUVuQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFNUQsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7QUFFMUIsZ0RBQWdEO0FBQ2hELE1BQU0sV0FBVyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLElBQUksS0FBSyxDQUV6RCxDQUFDO0FBQ1gsTUFBTSxnQkFBZ0IsR0FDcEIsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUM7SUFDMUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0I7SUFDOUIsRUFBRSxDQUFDO0FBQ0wsTUFBTSxrQkFBa0IsR0FDdEIsR0FBRyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUM7SUFDNUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0I7SUFDaEMsRUFBRSxDQUFDO0FBRUwsa0NBQWtDO0FBQ2xDLElBQUksQ0FBQyxnQkFBZ0IsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7SUFDN0MsT0FBTyxDQUFDLElBQUksQ0FDVixrREFBa0Q7UUFDaEQsbUZBQW1GLENBQ3RGLENBQUM7QUFDSixDQUFDO0FBRUQsbUJBQW1CO0FBQ25CLElBQUksY0FBYyxDQUFDLEdBQUcsRUFBRSxrQkFBa0IsV0FBVyxFQUFFLEVBQUU7SUFDdkQsV0FBVztJQUNYLGdCQUFnQjtJQUNoQixrQkFBa0I7SUFDbEIsR0FBRyxFQUFFO1FBQ0gsT0FBTyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CO1FBQ3hDLE1BQU0sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixJQUFJLGdCQUFnQjtLQUMzRDtJQUNELFdBQVcsRUFBRSxnRUFBZ0UsV0FBVyxHQUFHO0NBQzVGLENBQUMsQ0FBQztBQUVILEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIiMhL3Vzci9iaW4vZW52IG5weCB0cy1ub2RlIC0tZXNtXG5cbmltcG9ydCAqIGFzIGNkayBmcm9tIFwiYXdzLWNkay1saWJcIjtcblxuaW1wb3J0IHsgU3Rpbmd5VnBuU3RhY2sgfSBmcm9tIFwiLi4vbGliL3N0aW5neS12cG4tc3RhY2suanNcIjtcblxuY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcblxuLy8gR2V0IGNvbmZpZ3VyYXRpb24gZnJvbSBjb250ZXh0IG9yIGVudmlyb25tZW50XG5jb25zdCBlbnZpcm9ubWVudCA9IChhcHAubm9kZS50cnlHZXRDb250ZXh0KFwiZW52aXJvbm1lbnRcIikgPz8gXCJkZXZcIikgYXNcbiAgfCBcImRldlwiXG4gIHwgXCJwcm9kXCI7XG5jb25zdCBjbG91ZGZsYXJlWm9uZUlkID1cbiAgYXBwLm5vZGUudHJ5R2V0Q29udGV4dChcImNsb3VkZmxhcmVab25lSWRcIikgPz9cbiAgcHJvY2Vzcy5lbnYuQ0xPVURGTEFSRV9aT05FX0lEID8/XG4gIFwiXCI7XG5jb25zdCBjbG91ZGZsYXJlUmVjb3JkSWQgPVxuICBhcHAubm9kZS50cnlHZXRDb250ZXh0KFwiY2xvdWRmbGFyZVJlY29yZElkXCIpID8/XG4gIHByb2Nlc3MuZW52LkNMT1VERkxBUkVfUkVDT1JEX0lEID8/XG4gIFwiXCI7XG5cbi8vIFZhbGlkYXRlIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb25cbmlmICghY2xvdWRmbGFyZVpvbmVJZCB8fCAhY2xvdWRmbGFyZVJlY29yZElkKSB7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIldhcm5pbmc6IENsb3VkZmxhcmUgY29uZmlndXJhdGlvbiBub3QgcHJvdmlkZWQuIFwiICtcbiAgICAgIFwiU2V0IGNsb3VkZmxhcmVab25lSWQgYW5kIGNsb3VkZmxhcmVSZWNvcmRJZCB2aWEgY29udGV4dCBvciBlbnZpcm9ubWVudCB2YXJpYWJsZXMuXCJcbiAgKTtcbn1cblxuLy8gQ3JlYXRlIHRoZSBzdGFja1xubmV3IFN0aW5neVZwblN0YWNrKGFwcCwgYFN0aW5neVZwblN0YWNrLSR7ZW52aXJvbm1lbnR9YCwge1xuICBlbnZpcm9ubWVudCxcbiAgY2xvdWRmbGFyZVpvbmVJZCxcbiAgY2xvdWRmbGFyZVJlY29yZElkLFxuICBlbnY6IHtcbiAgICBhY2NvdW50OiBwcm9jZXNzLmVudi5DREtfREVGQVVMVF9BQ0NPVU5ULFxuICAgIHJlZ2lvbjogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfUkVHSU9OID8/IFwiYXAtbm9ydGhlYXN0LTFcIixcbiAgfSxcbiAgZGVzY3JpcHRpb246IGBTdGluZ3kgVlBOIC0gTG93LWNvc3QgVlBOIHNvbHV0aW9uIHVzaW5nIEVDMiBTcG90IEluc3RhbmNlcyAoJHtlbnZpcm9ubWVudH0pYCxcbn0pO1xuXG5hcHAuc3ludGgoKTtcbiJdfQ==